version: "3"

services:
  webserver:
    image: "konstatinkorobitsin/php-and-redis:1.0"
    container_name: webserver
    restart: always
    ports:
      - 8808:80
    volumes:
      - "./application/:/var/www/"
      - "./application/public/:/var/www/html"
      - "./configs/php/php.ini:/usr/local/etc/php/php.ini"
#    depends_on:
#      - mariaDb
#    links:
#      - mariaDb

#  mariaDb:
#    image: mariadb:10.9.3
#    container_name: mariaDb
#    restart: always
#    environment:
#      MYSQL_DATABASE: "${DB}"
#      MYSQL_USER: "${DB_USER}"
#      MYSQL_PASSWORD: "${DB_PASS}"
#      MYSQL_RANDOM_ROOT_PASSWORD: 'yes'
#    volumes:
#      - "db_volume:/var/lib/mysql"
#      - "./configs/mysql/slow-query.log:/var/log/mysql/mysql-slow.log"
#      - "./configs/mysql/my.cnf:/etc/mysql/conf.d/my.cnf"
#
#  pma:
#    image: phpmyadmin/phpmyadmin
#    container_name: pma
#    links:
#      - mariaDb
#    depends_on:
#      - mariaDb
#    environment:
#      PMA_HOST: mariaDb
#      PMA_PORT: 3306
#      PMA_ARBITRARY: 1
#    restart: always

  redis:
    image: redis:7.0.11-alpine
    container_name: redis
    restart: always
    #    ports:
    #      - '6379:6379'
    command: redis-server --save 20 1 --loglevel warning --requirepass eYVX7EwVmmxKPCDmwMtyKVge8oLd2t81
    volumes:
      - redis:/data

volumes:
  db_volume:
  redis: